[[inputs.tail]]
  ## Files to monitor. Glob patterns supported.
  files = ["/path/to/your/logfile.log"]

  ## Parse each log line with regex to extract JSON
  data_format = "grok"
  grok_patterns = ["%{TIMESTAMP_ISO8601:log_timestamp} %{WORD:source} %{GREEDYDATA:json_data}"]

  ## Extract the JSON part of the log
  [inputs.tail.tags]
    source = "{{source}}"  # Add the source (e.g., IPDMONITORING) as a tag

[[processors.parser]]
  ## Parse the extracted JSON
  namepass = ["tail"]  # Apply only to the `tail` input
  data_format = "json"
  field = "json_data"
